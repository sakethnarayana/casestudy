<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <plaintext>
from flask import Flask, request, jsonify
import json
import traceback
import openai
from flask_cors import CORS

app = Flask(__name__)
CORS(app)

@app.route('/clinicalSummary', methods=['POST'])
def clinicalSummary():
    try:
        received_json = request.json
        received_id = received_json['id']

        file_name = "testtoken.txt"
        with open(file_name, 'r') as file:
            lines_in_file = file.read()

        test = received_id + lines_in_file

        result = openai.ChatCompletion.create(
            engine="HomecareSummary",
            messages=[{"role": "user", "content": test}]
        )['choices'][0]['message']['content']

        return jsonify({'responseMessage': result})
    except Exception as e:
        return jsonify({'trace': traceback.format_exc()}), 500

@app.route('/conversationSummary', methods=['POST'])
def conversationSummary():
    try:
        received_json = request.json
        received_command = received_json["command"]
        received_conversation = received_json['conversation']

        test = received_command + '\n' + received_conversation

        result = openai.ChatCompletion.create(
            engine="HomecareSummary",
            messages=[{"role": "user", "content": test}]
        )['choices'][0]['message']['content']

        return jsonify({'responseMessage': result})
    except Exception as e:
        return jsonify({'trace': traceback.format_exc()}), 500

if __name__ == '__main__':
    openai.api_key = 'your_openai_api_key'
    openai.api_type = "azure"
    openai.api_base = "https://homecare.openai.azure.com/"
    openai.api_version = "2023-07-01-preview"
    
    app.run(port=5000, host='0.0.0.0')

      

  </plaintext>
</body>
</html>
